@using AntDesign
@using AntDesign.Charts
@using FramerateAnalyzer.Domain
@using Title = AntDesign.Charts.Title

@* <MudPaper Elevation="0" Class="d-flex justify-center align-center">
    <MudChart ChartType="MudBlazor.ChartType.Bar" ChartSeries="@_series" @bind-SelectedIndex="_index" Width="600px" Height="400px" XAxisLabels="@_xAxisLabels" AxisChartOptions="_axisChartOptions" />
</MudPaper>

@code {
    [Parameter]
    public IList<FramerateCaptureGroup> CaptureGroups { get; set; }

    private int _index = -1;

    private AxisChartOptions _axisChartOptions = new AxisChartOptions();

    private List<ChartSeries> _series = new List<ChartSeries>();

    private string[] _xAxisLabels;

    protected override void OnInitialized()
    {
        _axisChartOptions.MatchBoundsToSize = true;

        foreach (FramerateCaptureGroup group in CaptureGroups)
        {
            ChartSeries series = new ChartSeries()
            {
                Name = group.Cpu,
                Data = [group.Stats.Average, group.Stats.TenPercentLowAverage, group.Stats.OnePercentLowAverage, group.Stats.ZeroPointOnePercentLowAverage]
            };
            _series.Add(series);
        };

        _xAxisLabels = ["Average", "10% Low", "1% Low", "0.1% Low"];

        base.OnInitialized();
    }
} *@

<Tabs>
    <TabPane Key="1">
        <TabTemplate>示例1</TabTemplate>
        <ChildContent>
            <Bar Data="data1" Config="config1"/>
        </ChildContent>
    </TabPane>
</Tabs>

@code{
    [Parameter]
    public IList<FramerateCaptureGroup> CaptureGroups { get; set; }

    List<object> data1 = new();

    protected override void OnInitialized()
    {

        foreach (var group in CaptureGroups)
        {
            List<object> data = new List<object>()
            {
                new
                {
                    title = group.Cpu,
                    label = "Average",
                    data = group.Stats.Average
                },
                new
                {
                    title = group.Cpu,
                    label = "10% Low",
                    data = group.Stats.TenPercentLowAverage
                },
                new
                {
                    title = group.Cpu,
                    label = "1% Low",
                    data = group.Stats.OnePercentLowAverage
                },
                new
                {
                    title = group.Cpu,
                    label = "0.1% Low",
                    data = group.Stats.ZeroPointOnePercentLowAverage
                }
            };

            data1.AddRange(data);
        }
    }

    readonly BarConfig config1 = new BarConfig
    {
        Title = new Title
        {
            Visible = true,
            Text = "百分比堆叠条形图"
        },
        XField = "data",
        YField = "title",
        SeriesField = "label",
        Color = new[] {"#2582a1", "#f88c24", "#c52125", "#87f4d0"},
        Label = new BarViewConfigLabel
        {
            Visible = true
        }
    };
}